"use strict";(self.webpackChunkphysical_ai_humanoid_robotics_textbook=self.webpackChunkphysical_ai_humanoid_robotics_textbook||[]).push([[865],{1470:(e,n,s)=>{s.d(n,{A:()=>S});var r=s(6540),i=s(4164),t=s(7559),l=s(3104),o=s(6347),a=s(205),c=s(7485),d=s(1682),h=s(679);function u(e){var n,s;return null!=(n=null==(s=r.Children.toArray(e).filter(function(e){return"\n"!==e}).map(function(e){if(!e||(0,r.isValidElement)(e)&&((n=e.props)&&"object"==typeof n&&"value"in n))return e;var n;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')}))?void 0:s.filter(Boolean))?n:[]}function p(e){var n=e.values,s=e.children;return(0,r.useMemo)(function(){var e=null!=n?n:function(e){return u(e).map(function(e){var n=e.props;return{value:n.value,label:n.label,attributes:n.attributes,default:n.default}})}(s);return function(e){var n=(0,d.XI)(e,function(e,n){return e.value===n.value});if(n.length>0)throw new Error('Docusaurus error: Duplicate values "'+n.map(function(e){return e.value}).join(", ")+'" found in <Tabs>. Every value needs to be unique.')}(e),e},[n,s])}function m(e){var n=e.value;return e.tabValues.some(function(e){return e.value===n})}function g(e){var n=e.queryString,s=void 0!==n&&n,i=e.groupId,t=(0,o.W6)(),l=function(e){var n=e.queryString,s=void 0!==n&&n,r=e.groupId;if("string"==typeof s)return s;if(!1===s)return null;if(!0===s&&!r)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=r?r:null}({queryString:s,groupId:i});return[(0,c.aZ)(l),(0,r.useCallback)(function(e){if(l){var n=new URLSearchParams(t.location.search);n.set(l,e),t.replace(Object.assign({},t.location,{search:n.toString()}))}},[l,t])]}function x(e){var n,s,i,t,l=e.defaultValue,o=e.queryString,c=void 0!==o&&o,d=e.groupId,u=p(e),x=(0,r.useState)(function(){return function(e){var n,s=e.defaultValue,r=e.tabValues;if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(s){if(!m({value:s,tabValues:r}))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+s+'" but none of its children has the corresponding value. Available values are: '+r.map(function(e){return e.value}).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");return s}var i=null!=(n=r.find(function(e){return e.default}))?n:r[0];if(!i)throw new Error("Unexpected error: 0 tabValues");return i.value}({defaultValue:l,tabValues:u})}),j=x[0],b=x[1],f=g({queryString:c,groupId:d}),v=f[0],y=f[1],_=(n=function(e){return e?"docusaurus.tab."+e:null}({groupId:d}.groupId),s=(0,h.Dv)(n),i=s[0],t=s[1],[i,(0,r.useCallback)(function(e){n&&t.set(e)},[n,t])]),S=_[0],w=_[1],k=function(){var e=null!=v?v:S;return m({value:e,tabValues:u})?e:null}();return(0,a.A)(function(){k&&b(k)},[k]),{selectedValue:j,selectValue:(0,r.useCallback)(function(e){if(!m({value:e,tabValues:u}))throw new Error("Can't select invalid tab value="+e);b(e),y(e),w(e)},[y,w,u]),tabValues:u}}var j=s(2303);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var f=s(4848);function v(e){var n=e.className,s=e.block,r=e.selectedValue,t=e.selectValue,o=e.tabValues,a=[],c=(0,l.a_)().blockElementScrollPositionUntilNextRender,d=function(e){var n=e.currentTarget,s=a.indexOf(n),i=o[s].value;i!==r&&(c(n),t(i))},h=function(e){var n,s=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":var r,i=a.indexOf(e.currentTarget)+1;s=null!=(r=a[i])?r:a[0];break;case"ArrowLeft":var t,l=a.indexOf(e.currentTarget)-1;s=null!=(t=a[l])?t:a[a.length-1]}null==(n=s)||n.focus()};return(0,f.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":s},n),children:o.map(function(e){var n=e.value,s=e.label,t=e.attributes;return(0,f.jsx)("li",Object.assign({role:"tab",tabIndex:r===n?0:-1,"aria-selected":r===n,ref:function(e){a.push(e)},onKeyDown:h,onClick:d},t,{className:(0,i.A)("tabs__item",b.tabItem,null==t?void 0:t.className,{"tabs__item--active":r===n}),children:null!=s?s:n}),n)})})}function y(e){var n=e.lazy,s=e.children,t=e.selectedValue,l=(Array.isArray(s)?s:[s]).filter(Boolean);if(n){var o=l.find(function(e){return e.props.value===t});return o?(0,r.cloneElement)(o,{className:(0,i.A)("margin-top--md",o.props.className)}):null}return(0,f.jsx)("div",{className:"margin-top--md",children:l.map(function(e,n){return(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==t})})})}function _(e){var n=x(e);return(0,f.jsxs)("div",{className:(0,i.A)(t.G.tabs.container,"tabs-container",b.tabList),children:[(0,f.jsx)(v,Object.assign({},n,e)),(0,f.jsx)(y,Object.assign({},n,e))]})}function S(e){var n=(0,j.A)();return(0,f.jsx)(_,Object.assign({},e,{children:u(e.children)}),String(n))}},6282:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>a,metadata:()=>r,toc:()=>h});const r=JSON.parse('{"id":"chapters/ch3-ros2","title":"Chapter 3: ROS 2 Fundamentals","description":"Nodes, topics, services, packages\u2014building modular robot software with ROS 2 Humble. Practical workflows for real robot systems.","source":"@site/docs/chapters/ch3-ros2.mdx","sourceDirName":"chapters","slug":"/chapters/ch3-ros2","permalink":"/Physical-AI-Textbook/docs/chapters/ch3-ros2","draft":false,"unlisted":false,"editUrl":"https://github.com/Danishhshahid/docs/chapters/ch3-ros2.mdx","tags":[],"version":"current","frontMatter":{"id":"ch3-ros2","title":"Chapter 3: ROS 2 Fundamentals","sidebar_label":"Ch3: ROS 2 Fundamentals","description":"Nodes, topics, services, packages\u2014building modular robot software with ROS 2 Humble. Practical workflows for real robot systems.","keywords":["ros2","nodes","topics","services","packages","colcon","middleware","dds","python","rclpy"]},"sidebar":"tutorialSidebar","previous":{"title":"Ch2: Humanoid Basics","permalink":"/Physical-AI-Textbook/docs/chapters/ch2-humanoid"},"next":{"title":"Ch4: Simulation","permalink":"/Physical-AI-Textbook/docs/chapters/ch4-sim"}}');var i=s(4848),t=s(8453),l=s(1470),o=s(9365);const a={id:"ch3-ros2",title:"Chapter 3: ROS 2 Fundamentals",sidebar_label:"Ch3: ROS 2 Fundamentals",description:"Nodes, topics, services, packages\u2014building modular robot software with ROS 2 Humble. Practical workflows for real robot systems.",keywords:["ros2","nodes","topics","services","packages","colcon","middleware","dds","python","rclpy"]},c="Chapter 3: ROS 2 Fundamentals",d={},h=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"3.1: What is ROS 2?",id:"31-what-is-ros-2",level:2},{value:"The Problem ROS 2 Solves",id:"the-problem-ros-2-solves",level:3},{value:"ROS 2 vs. ROS 1",id:"ros-2-vs-ros-1",level:3},{value:"DDS: The Middleware",id:"dds-the-middleware",level:3},{value:"3.2: Nodes &amp; the Computation Graph",id:"32-nodes--the-computation-graph",level:2},{value:"What is a Node?",id:"what-is-a-node",level:3},{value:"Example: Create Your First Node",id:"example-create-your-first-node",level:3},{value:"3.3: Topics &amp; Pub/Sub Pattern",id:"33-topics--pubsub-pattern",level:2},{value:"Why Pub/Sub?",id:"why-pubsub",level:3},{value:"Real-World Example: Robot Telemetry",id:"real-world-example-robot-telemetry",level:3},{value:"Code: Publish Joint States (for simulation)",id:"code-publish-joint-states-for-simulation",level:3},{value:"QoS Profiles",id:"qos-profiles",level:3},{value:"3.4: Services &amp; RPC",id:"34-services--rpc",level:2},{value:"When to Use Services?",id:"when-to-use-services",level:3},{value:"Code: Add Two Numbers Service",id:"code-add-two-numbers-service",level:3},{value:"3.5: Packages &amp; Build System",id:"35-packages--build-system",level:2},{value:"ROS 2 Package Structure",id:"ros-2-package-structure",level:3},{value:"Build with colcon",id:"build-with-colcon",level:3},{value:"3.6: CLI Tools &amp; Introspection",id:"36-cli-tools--introspection",level:2},{value:"Discover Running System",id:"discover-running-system",level:3},{value:"3.7: Embodiment Challenge",id:"37-embodiment-challenge",level:2},{value:"<strong>Build a Real-Time Robot Telemetry System</strong>",id:"build-a-real-time-robot-telemetry-system",level:3},{value:"References",id:"references",level:2},{value:"Next Steps",id:"next-steps",level:2},{value:"RAG Integration Hooks",id:"rag-integration-hooks",level:2}];function u(e){const n={a:"a",admonition:"admonition",code:"code",div:"div",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"chapter-3-ros-2-fundamentals",children:"Chapter 3: ROS 2 Fundamentals"})}),"\n",(0,i.jsx)(n.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,i.jsxs)(n.admonition,{type:"info",children:[(0,i.jsx)(n.p,{children:"After this chapter, you will:"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Understand"})," the ROS 2 graph architecture: decentralized, middleware-agnostic design"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Build"})," your own ROS 2 nodes using rclpy (Python client library)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Implement"})," pub/sub patterns for sensor data streaming (topics)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Implement"})," RPC patterns for one-time requests (services)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Use"})," ROS 2 CLI tools for system introspection (",(0,i.jsx)(n.code,{children:"ros2 topic"}),", ",(0,i.jsx)(n.code,{children:"ros2 service"}),", ",(0,i.jsx)(n.code,{children:"rqt_graph"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Create"})," ROS 2 packages and launch files for multi-node orchestration"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Deploy"})," on Ubuntu 22.04 and Jetson Orin using colcon build system"]}),"\n"]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"31-what-is-ros-2",children:"3.1: What is ROS 2?"}),"\n",(0,i.jsx)(n.h3,{id:"the-problem-ros-2-solves",children:"The Problem ROS 2 Solves"}),"\n",(0,i.jsx)(n.p,{children:"Imagine building a humanoid robot with 100+ sensors and actuators:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"50 sensors"})," (cameras, IMU, force sensors, joint encoders)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"30 actuators"})," (motors for joints)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"10 planning/reasoning modules"})," (inverse kinematics, collision detection, vision processing)"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Without standardization, this becomes a wiring nightmare:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Each module needs custom code to talk to each other"}),"\n",(0,i.jsx)(n.li,{children:"Sensor data must be serialized/deserialized"}),"\n",(0,i.jsx)(n.li,{children:"Network communication is ad-hoc (UDP, TCP, custom protocols)"}),"\n",(0,i.jsx)(n.li,{children:"Testing is impossible without the full robot"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"ROS 2 (Robot Operating System 2)"})," solves this by providing:"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Middleware abstraction"}),": Swap communication backends (DDS, custom protocols) without changing user code"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Standard message types"}),": ",(0,i.jsx)(n.code,{children:"std_msgs"}),", ",(0,i.jsx)(n.code,{children:"sensor_msgs"}),", ",(0,i.jsx)(n.code,{children:"geometry_msgs"})," for common data"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Pub/sub architecture"}),": Loose coupling between nodes"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Service RPC"}),": Synchronous request-response for critical commands"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"CLI tooling"}),": Inspect running system without writing code"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"ros-2-vs-ros-1",children:"ROS 2 vs. ROS 1"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Feature"}),(0,i.jsx)(n.th,{children:"ROS 1"}),(0,i.jsx)(n.th,{children:"ROS 2"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Architecture"})}),(0,i.jsx)(n.td,{children:"Central master node"}),(0,i.jsx)(n.td,{children:"Fully decentralized"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Middleware"})}),(0,i.jsx)(n.td,{children:"Custom (roscomm)"}),(0,i.jsx)(n.td,{children:"DDS (industry standard)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Real-time"})}),(0,i.jsx)(n.td,{children:"No"}),(0,i.jsx)(n.td,{children:"Yes (real-time DDS profiles)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Security"})}),(0,i.jsx)(n.td,{children:"Minimal"}),(0,i.jsx)(n.td,{children:"Full (encryption, authentication)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Python 3"})}),(0,i.jsx)(n.td,{children:"Limited"}),(0,i.jsx)(n.td,{children:"Native"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Windows/Mac"})}),(0,i.jsx)(n.td,{children:"Limited"}),(0,i.jsx)(n.td,{children:"Full support"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Status"})}),(0,i.jsx)(n.td,{children:"EOL (end of life)"}),(0,i.jsx)(n.td,{children:"Active (Humble LTS until 2027)"})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Recommendation"}),": Start with ROS 2 Humble (long-term support, production-ready)."]}),"\n",(0,i.jsx)(n.h3,{id:"dds-the-middleware",children:"DDS: The Middleware"}),"\n",(0,i.jsxs)(n.p,{children:["ROS 2 uses ",(0,i.jsx)(n.strong,{children:"DDS (Data Distribution Service)"})," as its underlying middleware. DDS is:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Open standard"})," (OMG - Object Management Group)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Used in defense, maritime, finance"})," (battle-tested)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Quality of Service (QoS)"}),": Tunable reliability, latency, bandwidth"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Multiple implementations"}),": Fast-DDS (default), CycloneDDS, RTI Connext"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Key concept: ",(0,i.jsx)(n.strong,{children:"Domain ID"})," isolates ROS 2 networks:\nDDS Domain ID \u2208 [0, 232]"]}),"\n",(0,i.jsx)(n.p,{children:"Two robots on the same network with different Domain IDs won't interfere with each other."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"32-nodes--the-computation-graph",children:"3.2: Nodes & the Computation Graph"}),"\n",(0,i.jsx)(n.h3,{id:"what-is-a-node",children:"What is a Node?"}),"\n",(0,i.jsxs)(n.p,{children:["A ",(0,i.jsx)(n.strong,{children:"node"})," is a process that performs one logical function:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-mermaid",children:'graph LR\n    Camera["\ud83d\udcf7 Camera Driver<br/>(Node)"]\n    Vision["\ud83d\udc41\ufe0f Vision<br/>(Node)"]\n    Control["\ud83c\udfae Control<br/>(Node)"]\n    Motor["\u2699\ufe0f Motor Driver<br/>(Node)"]\n\n    Camera --\x3e|/camera/rgb| Vision\n    Vision --\x3e|/detected_objects| Control\n    Control --\x3e|/joint_commands| Motor\n\n    style Camera fill:#e1f5ff\n    style Vision fill:#fff3e0\n    style Control fill:#f3e5f5\n    style Motor fill:#e8f5e9\n'})}),"\n",(0,i.jsx)(n.p,{children:"Each node:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Runs in its own process (crash doesn't kill others)"}),"\n",(0,i.jsx)(n.li,{children:"Communicates via topics (pub/sub) and services (RPC)"}),"\n",(0,i.jsx)(n.li,{children:"Has its own lifecycle"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"example-create-your-first-node",children:"Example: Create Your First Node"}),"\n",(0,i.jsxs)(l.A,{children:[(0,i.jsxs)(o.A,{value:"talker",label:"Publisher Node (talker.py)",children:[(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'#!/usr/bin/env python3\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass TalkerNode(Node):\n    """Publisher node: sends messages to /chatter topic."""\n\n    def __init__(self):\n        super().__init__(\'talker\')\n\n        # Create publisher: topic name, message type, queue size\n        self.publisher_ = self.create_publisher(String, \'/chatter\', 10)\n\n        # Create timer: callback every 0.1 seconds (10 Hz)\n        timer_period = 0.1\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n\n        self.counter = 0\n\n    def timer_callback(self):\n        """Called every 0.1 seconds."""\n        msg = String()\n        msg.data = f\'Hello World: {self.counter}\'\n        self.publisher_.publish(msg)\n        self.get_logger().info(f\'Publishing: "{msg.data}"\')\n        self.counter += 1\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = TalkerNode()\n\n    # Spin: process callbacks indefinitely\n    rclpy.spin(node)\n\n    # Cleanup (reached if interrupted, e.g., Ctrl+C)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == \'__main__\':\n    main()\n'})}),(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Run it"}),":"]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Terminal 1\nsource /opt/ros/humble/setup.bash\npython3 talker.py\n# Output:\n# [INFO] Publishing: "Hello World: 0"\n# [INFO] Publishing: "Hello World: 1"\n# ...\n'})})]}),(0,i.jsxs)(o.A,{value:"listener",label:"Subscriber Node (listener.py)",children:[(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'#!/usr/bin/env python3\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass ListenerNode(Node):\n    """Subscriber node: listens to /chatter topic."""\n\n    def __init__(self):\n        super().__init__(\'listener\')\n\n        # Create subscriber: topic name, message type, callback, queue size\n        self.subscription = self.create_subscription(\n            String,\n            \'/chatter\',\n            self.listener_callback,\n            10\n        )\n\n    def listener_callback(self, msg):\n        """Called whenever a message arrives on /chatter."""\n        self.get_logger().info(f\'I heard: "{msg.data}"\')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = ListenerNode()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == \'__main__\':\n    main()\n'})}),(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Run it"})," (in a separate terminal):"]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Terminal 2\nsource /opt/ros/humble/setup.bash\npython3 listener.py\n# Output:\n# [INFO] I heard: "Hello World: 0"\n# [INFO] I heard: "Hello World: 1"\n# ...\n'})})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"33-topics--pubsub-pattern",children:"3.3: Topics & Pub/Sub Pattern"}),"\n",(0,i.jsx)(n.h3,{id:"why-pubsub",children:"Why Pub/Sub?"}),"\n",(0,i.jsx)(n.p,{children:"Pub/Sub decouples producers from consumers:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Publisher"})," sends messages to a topic; doesn't know or care about subscribers"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Subscriber"})," listens to a topic; doesn't care about publishers"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Multiple pubs/subs"})," on same topic (many-to-many communication)"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"real-world-example-robot-telemetry",children:"Real-World Example: Robot Telemetry"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-mermaid",children:'graph TD\n    Sensors["\ud83d\udce1 Sensor Drivers<br/>(Publish joint_states, imu, forces)"]\n    Logger["\ud83d\udcdd Data Logger<br/>(Subscribe to all topics)"]\n    Monitor["\ud83d\udcca Monitor<br/>(Subscribe to joint_states)"]\n    Control["\ud83c\udfae Controller<br/>(Subscribe to imu for balance)"]\n\n    Sensors --\x3e|/joint_states| Logger\n    Sensors --\x3e|/imu/data| Logger\n    Sensors --\x3e|/joint_states| Monitor\n    Sensors --\x3e|/imu/data| Control\n    Sensors --\x3e|/force_torque| Logger\n\n    style Sensors fill:#e1f5ff\n    style Logger fill:#fff3e0\n    style Monitor fill:#f3e5f5\n    style Control fill:#e8f5e9\n'})}),"\n",(0,i.jsx)(n.p,{children:"Each subscriber receives the same data; sensor drivers don't need to know who's listening."}),"\n",(0,i.jsx)(n.h3,{id:"code-publish-joint-states-for-simulation",children:"Code: Publish Joint States (for simulation)"}),"\n",(0,i.jsx)(l.A,{children:(0,i.jsx)(o.A,{value:"joint_pub",label:"Joint State Publisher",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\nimport rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import JointState\nimport numpy as np\n\nclass JointStatePublisher(Node):\n    \"\"\"Publish joint states from simulated 2-DOF arm.\"\"\"\n\n    def __init__(self):\n        super().__init__('joint_publisher')\n        self.publisher_ = self.create_publisher(JointState, '/joint_states', 10)\n        self.timer = self.create_timer(0.05, self.timer_callback)  # 20 Hz\n        self.time = 0.0\n\n    def timer_callback(self):\n        msg = JointState()\n        msg.header.stamp = self.get_clock().now().to_msg()\n        msg.header.frame_id = 'base_link'\n        msg.name = ['joint_1', 'joint_2']\n\n        # Simulate sinusoidal motion\n        msg.position = [\n            np.sin(self.time),\n            np.cos(2 * self.time)\n        ]\n        msg.velocity = [\n            np.cos(self.time),\n            -2 * np.sin(2 * self.time)\n        ]\n        msg.effort = [0.5, 0.3]  # Torques\n\n        self.publisher_.publish(msg)\n        self.time += 0.05\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = JointStatePublisher()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})})})}),"\n",(0,i.jsx)(n.h3,{id:"qos-profiles",children:"QoS Profiles"}),"\n",(0,i.jsx)(n.p,{children:"ROS 2 QoS policies control reliability vs. latency trade-off:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"from rclpy.qos import QoSProfile, ReliabilityPolicy, HistoryPolicy\n\n# High-bandwidth sensor data: best-effort, low latency\nqos_sensor = QoSProfile(\n    reliability=ReliabilityPolicy.BEST_EFFORT,\n    history=HistoryPolicy.KEEP_LAST,\n    depth=5\n)\n\n# Critical commands: reliable delivery\nqos_critical = QoSProfile(\n    reliability=ReliabilityPolicy.RELIABLE,\n    history=HistoryPolicy.KEEP_ALL\n)\n\nsubscriber = self.create_subscription(\n    Imu, '/imu/data', self.imu_callback, qos_sensor\n)\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"34-services--rpc",children:"3.4: Services & RPC"}),"\n",(0,i.jsx)(n.h3,{id:"when-to-use-services",children:"When to Use Services?"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Topics"}),": Continuous streaming (sensor data, 100+ Hz)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Services"}),": One-time queries or critical commands (IK request, gripper activation)"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"code-add-two-numbers-service",children:"Code: Add Two Numbers Service"}),"\n",(0,i.jsxs)(l.A,{children:[(0,i.jsx)(o.A,{value:"service_server",label:"Service Server",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'#!/usr/bin/env python3\nimport rclpy\nfrom rclpy.node import Node\nfrom example_interfaces.srv import AddTwoInts\n\nclass AddTwoIntsServer(Node):\n    """Service server: adds two integers on request."""\n\n    def __init__(self):\n        super().__init__(\'add_server\')\n        self.srv = self.create_service(\n            AddTwoInts,\n            \'/add_two_ints\',\n            self.add_callback\n        )\n        self.get_logger().info(\'Service /add_two_ints is ready\')\n\n    def add_callback(self, request, response):\n        """Handle incoming service request."""\n        response.sum = request.a + request.b\n        self.get_logger().info(f\'Request: {request.a} + {request.b} = {response.sum}\')\n        return response\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = AddTwoIntsServer()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == \'__main__\':\n    main()\n'})})}),(0,i.jsxs)(o.A,{value:"service_client",label:"Service Client",children:[(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\nimport rclpy\nfrom rclpy.node import Node\nfrom example_interfaces.srv import AddTwoInts\nimport sys\n\nclass AddTwoIntsClient(Node):\n    \"\"\"Service client: calls /add_two_ints service.\"\"\"\n\n    def __init__(self, a, b):\n        super().__init__('add_client')\n        self.cli = self.create_client(AddTwoInts, '/add_two_ints')\n\n        # Wait for service to become available\n        while not self.cli.wait_for_service(timeout_sec=1.0):\n            self.get_logger().info('Waiting for service...')\n\n        self.req = AddTwoInts.Request()\n        self.req.a = a\n        self.req.b = b\n\n    def send_request(self):\n        self.future = self.cli.call_async(self.req)\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    if len(sys.argv) != 3:\n        print(\"Usage: python3 client.py <a> <b>\")\n        return\n\n    a, b = int(sys.argv[1]), int(sys.argv[2])\n    client = AddTwoIntsClient(a, b)\n    client.send_request()\n\n    # Wait for response (blocking)\n    rclpy.spin_until_future_complete(client, client.future)\n    result = client.future.result()\n\n    client.get_logger().info(f'{a} + {b} = {result.sum}')\n    client.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Run it"}),":"]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Terminal 1: Start server\npython3 server.py\n\n# Terminal 2: Call service\npython3 client.py 3 5\n# Output: 3 + 5 = 8\n"})})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"35-packages--build-system",children:"3.5: Packages & Build System"}),"\n",(0,i.jsx)(n.h3,{id:"ros-2-package-structure",children:"ROS 2 Package Structure"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"my_robot_pkg/\n\u251c\u2500\u2500 package.xml          # Metadata\n\u251c\u2500\u2500 setup.py             # Python setup\n\u251c\u2500\u2500 my_robot_pkg/        # Source code\n\u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u251c\u2500\u2500 talker.py\n\u2502   \u2514\u2500\u2500 listener.py\n\u2514\u2500\u2500 test/                # Unit tests\n"})}),"\n",(0,i.jsx)(n.h3,{id:"build-with-colcon",children:"Build with colcon"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Build all packages in workspace\ncolcon build\n\n# Build specific package\ncolcon build --packages-select my_robot_pkg\n\n# Build and test\ncolcon build --cmake-args -DCMAKE_BUILD_TYPE=Release\n\n# After building, source install\nsource install/setup.bash\n\n# Now you can run nodes\nros2 run my_robot_pkg talker\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"36-cli-tools--introspection",children:"3.6: CLI Tools & Introspection"}),"\n",(0,i.jsx)(n.h3,{id:"discover-running-system",children:"Discover Running System"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# List all nodes\nros2 node list\n\n# List all topics\nros2 topic list\n\n# List all services\nros2 service list\n\n# Echo topic data (real-time)\nros2 topic echo /joint_states\n\n# Measure topic frequency\nros2 topic hz /joint_states\n\n# Visualize computation graph\nrqt_graph\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"37-embodiment-challenge",children:"3.7: Embodiment Challenge"}),"\n",(0,i.jsxs)(n.admonition,{type:"danger",children:[(0,i.jsx)(n.h3,{id:"build-a-real-time-robot-telemetry-system",children:(0,i.jsx)(n.strong,{children:"Build a Real-Time Robot Telemetry System"})}),(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Problem"}),":"]}),(0,i.jsx)(n.p,{children:"Design a ROS 2 system that streams real-time sensor data from a simulated humanoid robot to a monitoring dashboard."}),(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Requirements"}),":"]}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Sensor node"}),": Publishes joint positions (50 Hz), IMU data (100 Hz), forces (30 Hz)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Logger node"}),": Subscribes to all topics; records to CSV file"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Monitor node"}),": Visualizes live joint positions (real-time plot)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"No packet loss"}),": All data must arrive in order"]}),"\n"]}),(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Current Benchmarks"}),":"]}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Tesla Optimus: Streams 200+ sensors in real-time"}),"\n",(0,i.jsx)(n.li,{children:"Boston Dynamics Atlas: 100+ Hz control loop"}),"\n",(0,i.jsx)(n.li,{children:"Figure AI: Real-time telemetry at 50-100 Hz for arm tasks"}),"\n"]}),(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Your Deliverable"}),":"]}),(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Sensor node"})," (simulates joint states, IMU, forces)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Logger node"})," (writes to CSV with timestamps)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Monitor node"})," (displays statistics: mean position, frequency, packet loss)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Measurement"}),": Latency from sensor publish to logger write (goal: under 50 ms)"]}),"\n"]}),(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Success Metrics"}),":"]}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u2705 All three nodes run without errors"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Topics publish at correct frequencies"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Logger records 100% of messages"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Monitor shows live statistics"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Latency under 50 ms p95"}),"\n"]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,i.jsxs)(n.p,{children:["[1] ",(0,i.jsx)(n.strong,{children:"ROS 2 Official Documentation"}),". (2024). ",(0,i.jsx)(n.em,{children:"ROS 2 Humble Hawksbill"}),". ",(0,i.jsx)(n.a,{href:"https://docs.ros.org/en/humble/",children:"https://docs.ros.org/en/humble/"})]}),"\n",(0,i.jsxs)(n.p,{children:["[2] ",(0,i.jsx)(n.strong,{children:"Object Management Group (OMG)"}),". (2015). ",(0,i.jsx)(n.em,{children:"Data Distribution Service (DDS) Standard"}),". ",(0,i.jsx)(n.a,{href:"https://www.omg.org/spec/DDS/",children:"https://www.omg.org/spec/DDS/"})]}),"\n",(0,i.jsxs)(n.p,{children:["[3] ",(0,i.jsx)(n.strong,{children:"Brown, C., et al."}),' (2022). "ROS 2: The Robotics Operating System for the Next Decade." ',(0,i.jsx)(n.em,{children:"IEEE Robotics & Automation Magazine"}),", 29(4), 102\u2013112."]}),"\n",(0,i.jsxs)(n.p,{children:["[4] ",(0,i.jsx)(n.strong,{children:"Macenski, S., et al."}),' (2022). "Robot Operating System 2: Design, Architecture, and Uses in the Wild." ',(0,i.jsx)(n.em,{children:"Science Robotics"}),", 7(66), eabm6293."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,i.jsxs)(n.admonition,{type:"info",children:[(0,i.jsxs)(n.p,{children:["\u2705 ",(0,i.jsx)(n.strong,{children:"You now know how to code robot software"})," using ROS 2: nodes, topics, services, packages."]}),(0,i.jsxs)(n.p,{children:["\u2192 ",(0,i.jsx)(n.strong,{children:"Chapter 4: Digital Twin Simulation"})," teaches you to ",(0,i.jsx)(n.strong,{children:"simulate"})," all these concepts in Gazebo before running on real hardware."]}),(0,i.jsxs)(n.p,{children:["Ready? \u2192 ",(0,i.jsx)(n.a,{href:"/Physical-AI-Textbook/docs/chapters/ch4-sim",children:(0,i.jsx)(n.strong,{children:"Chapter 4: Digital Twin Simulation"})})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"rag-integration-hooks",children:"RAG Integration Hooks"}),"\n",(0,i.jsxs)(n.div,{children:[(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:'"What\'s the difference between ROS 1 and ROS 2? Should I learn ROS 1 first?"'})}),(0,i.jsx)(n.p,{children:"No\u2014start with ROS 2. ROS 1 is end-of-life; ROS 2 is production-ready and will dominate for the next decade."})]}),"\n",(0,i.jsxs)(n.div,{children:[(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:'"How do I debug ROS 2 latency issues in my robot system?"'})}),(0,i.jsxs)(n.p,{children:["Use ",(0,i.jsx)(n.code,{children:"ros2 topic hz"})," to measure frequencies, ",(0,i.jsx)(n.code,{children:"rqt_graph"})," to visualize connections, and ",(0,i.jsx)(n.code,{children:"rclpy"})," logging to trace message timestamps."]})]}),"\n",(0,i.jsxs)(n.div,{children:[(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:'"Should I use topics or services for my robot\'s sensor data?"'})}),(0,i.jsx)(n.p,{children:"Topics for continuous streams (cameras, IMU, joint encoders). Services for one-time requests (inverse kinematics, gripper activation)."})]})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>o});var r=s(6540);const i={},t=r.createContext(i);function l(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(t.Provider,{value:n},e.children)}},9365:(e,n,s)=>{s.d(n,{A:()=>l});s(6540);var r=s(4164);const i={tabItem:"tabItem_Ymn6"};var t=s(4848);function l(e){var n=e.children,s=e.hidden,l=e.className;return(0,t.jsx)("div",{role:"tabpanel",className:(0,r.A)(i.tabItem,l),hidden:s,children:n})}}}]);